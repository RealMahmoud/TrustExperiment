<div class=" row">
  <div class="col-6">
    <div class="card " id="empty_card" style="text-align:center;">
      <h5 class="info_block__accent">Enter Address</h5>
      <form METHOD="POST" onsubmit="check(); return false;">
        <div class="input-group">
          <input id="Address" class="formVal form-control" value=""></input><br>
        </div>
        <a class="btn btn-secondary btn-small" href='#' onclick="paste('Address'); return false;">
          <i class="icon icon--thin_arrow_right"></i>
          <span>Paste</span>
          <i class="icon icon--thin_arrow_left"></i>
        </a>
        <a class="btn btn-secondary btn-small" href='#' onclick="Clear('Address'); return false;">
          <i class="icon icon--thin_arrow_left"></i>
          <span>Clear</span>
          <i class="icon icon--thin_arrow_right"></i>
        </a>
        <a class="btn btn-secondary btn-small" href='#' onclick="check(); return false;">
          <span id="text_submit">Check</span>
        </a>
      </form>
    </div>



    <div class="card " id="empty_card" style="text-align:center;">
      <h5 class="info_block__accent">Send invite</h5>
      <form METHOD="POST" onsubmit="check(); return false;">
        <div class="input-group">
          <input id="INVITE" class="formVal form-control" value="" disabled></input><br>
        </div>
        <a class="btn btn-secondary btn-small" href='#' onclick="paste('INVITE'); return false;" disabled>
          <i class="icon icon--thin_arrow_right"></i>
          <span>Paste</span>
          <i class="icon icon--thin_arrow_left"></i>
        </a>
        <a class="btn btn-secondary btn-small" href='#' onclick="Clear('INVITE'); return false;" disabled>
          <i class="icon icon--thin_arrow_left"></i>
          <span>Clear</span>
          <i class="icon icon--thin_arrow_right"></i>
        </a>
        <a class="btn btn-secondary btn-small" href='#' onclick="INVITE(); return false;" disabled>
          <span id="text_submit">Send</span>
        </a>

      </form>
    </div>
  </div>
  <div class="col-6">
    <div class="card" id="empty_card" style="text-align:center;">
      <div id='container'>

        <div class="user-pic" style="margin-right: 0px;"><img id="CheckerPic" class="user-avatar"
            src="./images/logo_light.png" alt="pic" width="100"></div>
            <br>
            <br>
            
        <p class="voteslbl mb-0" id="result-address">Address :</p>
        <p class="catlbl mb-0" id="result-age">Age :</p>
        <p class="violbl mb-0" id="result-status">Status :</p>
        <p class="timelbl mb-0" id="result-doubleCheck">Double Check : </p>
        <p class="timelbl mb-0" id="result-time">Last successful login :</p>

      </div>
    </div>
  </div>
</div>


<!-- this is to close main, div opened in the header -->
</div>
</main>
<script type="text/javascript">
  async function paste(id) {
    const text = await navigator.clipboard.readText();
    document.getElementById(id).value = text;
  }

  function Clear(id) {
    document.getElementById(id).value = '';
  }

  function doubleCheck(nonce, sig, address) {
    var formData = new FormData();
    formData.append('nonce', nonce);
    formData.append('sig', sig);
    formData.append('address', address);
    ajax_post('./services/doubleCheck.php', formData, function (data) {
      if (data['result'] == null) {
        document.getElementById("result-doubleCheck").innerHTML = 'Double Check : Failed';
      } else {
        document.getElementById("result-doubleCheck").innerHTML = 'Double Check : ' + data['result'];
      }

    });
  }

  function apiPull(address) {
    ajax_get('https://api.idena.org/api/identity/' + address + '/age', function (data) {
      document.getElementById("result-age").innerHTML = 'Age : ' + data['result'];
    });
    ajax_get('https://api.idena.org/api/identity/' + address, function (data) {
      document.getElementById("result-status").innerHTML = 'Status : ' + data['result']['state'];
    });


  }

  function check() {
    var formData = new FormData();
    formData.append('Address', document.getElementById("Address").value);
    if (document.getElementById("Address").value == '' || document.getElementById("Address").value == null) {
      return
    }
    ajax_post('./services/checkAddress.php', formData, function (data) {
      if (data['id'] == '--') {
        document.getElementById("CheckerPic").src = './images/logo_light.png';
        document.getElementById("result-address").innerHTML = 'Address : --';
        document.getElementById("result-time").innerHTML = 'Last successful login : --';
        document.getElementById("result-doubleCheck").innerHTML = 'Double Check : --';
        document.getElementById("result-age").innerHTML = 'Age : --';
        document.getElementById("result-status").innerHTML = 'Status : --';
      } else {
        document.getElementById("CheckerPic").src = 'https://robohash.org/' + data['address'];
        document.getElementById("result-address").innerHTML = 'Address : ' + data['address'];
        apiPull(document.getElementById("Address").value);
        doubleCheck(data['lastNonce'], data['lastSig'], data['address']);
        document.getElementById("result-time").innerHTML = 'Last successful login : ' + moment.utc(data['time'])
          .local().format(
            'YYYY-MM-DD HH:mm A');
      }






    });
  }
</script>